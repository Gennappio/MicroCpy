# Jayatilake Metabolic Symbiosis Experiment - 2D CSV Version
# Demonstrates the new CSV initial state format for 2D simulations

# DEBUG FLAGS
debug_phenotype_detailed: false
log_simulation_status: true

# Domain configuration - 2D simulation with CSV initial state
domain:
  size_x: 500.0
  size_x_unit: "um"
  size_y: 500.0
  size_y_unit: "um"
  nx: 25
  ny: 25
  dimensions: 2
  cell_height: 20.0          # Cell size in micrometers (matches CSV metadata)
  cell_height_unit: "um"

# Time configuration
time:
  dt: 0.1
  end_time: 0.5  # Short run for testing
  diffusion_step: 1
  intracellular_step: 1
  intercellular_step: 1

# Diffusion solver configuration
diffusion:
  max_iterations: 1000
  tolerance: 1e-6
  solver_type: "steady_state"
  twodimensional_adjustment_coefficient: 1.0

# Output configuration
output:
  save_data_interval: 1
  save_plots_interval: 1
  save_final_plots: true
  save_initial_plots: true
  status_print_interval: 1
  save_cellstate_interval: 1

# Initial state configuration - CSV format for 2D
initial_state:
  file_path: "microc-2.0/tests/jayatilake_experiment/example_2d_cells.csv"  # Human-readable CSV format

# Substances (simplified for 2D demo)
substances:
  Oxygen:
    diffusion_coeff: 1.0e-9
    production_rate: 0.0
    uptake_rate: 3.0e-17
    initial_value: 0.07
    boundary_value: 0.07
    boundary_type: "fixed"
    unit: "mM"

  Glucose:
    diffusion_coeff: 6.70e-11
    production_rate: 0.0
    uptake_rate: 3.0e-15
    initial_value: 5.0
    boundary_value: 5.0
    boundary_type: "fixed"
    unit: "mM"

  Lactate:
    diffusion_coeff: 6.70e-11
    production_rate: 3.0e-15
    uptake_rate: 0.0
    initial_value: 1.0
    boundary_value: 1.0
    boundary_type: "fixed"
    unit: "mM"

  H:
    diffusion_coeff: 1.0e-9
    production_rate: 2.0e-20
    uptake_rate: 3.0e-15
    initial_value: 4e-5
    boundary_value: 4e-5
    boundary_type: "fixed"
    unit: "mM"

  pH:
    diffusion_coeff: 1.0e-9
    production_rate: 0.0
    uptake_rate: 0.0
    initial_value: 7.4
    boundary_value: 7.4
    boundary_type: "fixed"
    unit: "pH"

# Substance-to-gene network associations
associations:
  Oxygen: "Oxygen_supply"
  Glucose: "Glucose_supply"
  Lactate: "MCT1_stimulus"
  H: "Proton_level"

# Gene activation thresholds
thresholds:
  Oxygen_supply:
    threshold: 0.022
  Glucose_supply:
    threshold: 0.5
  MCT1_stimulus:
    threshold: 2.0
  Proton_level:
    threshold: 0.00008

# Gene network configuration
gene_network:
  # Use the same .bnd file as the 3D version
  bnd_file: "jaya_microc.bnd"
  propagation_steps: 500
  random_initialization: true
  output_nodes: ["Proliferation", "Apoptosis", "Growth_Arrest", "Necrosis"]

  nodes:
    # Input nodes
    Oxygen_supply:
      is_input: true
      default_state: true
    Glucose_supply:
      is_input: true
      default_state: true
    MCT1_stimulus:
      is_input: true
      default_state: true
    Proton_level:
      is_input: true
      default_state: false

# Environment configuration
environment:
  ph: 7.4

# Custom parameters (for custom functions)
custom_parameters:
  # Cell behavior parameters
  cell_cycle_time: 240           # Minimum time for cell division (240 iterations = 24 hours at dt=0.1)
  max_cell_age: 500.0            # Maximum cell age in hours before death

  # ATP parameters
  max_atp: 30                    # Maximum ATP per glucose molecule
  max_atp_rate: 1.0e-14          # Maximum ATP production rate (mol/s)
  atp_threshold: 0.8             # ATP threshold for proliferation

  # Metabolic parameters
  glyco_oxygen_ratio: 0.1        # Oxygen consumption ratio for glycolysis vs OXPHOS
  proton_coefficient: 0.01       # Proton production coefficient
  glucose_factor: 2              # Glucose consumption factor

  # Michaelis constants
  KG: 0.5                        # Michaelis constant for glucose (mM)
  KO2: 0.01                      # Michaelis constant for oxygen (mM)
  KL: 1.0                        # Michaelis constant for lactate (mM)

  # Vmax parameters
  oxygen_vmax: 1.0e-16           # Maximum oxygen uptake rate
  glucose_vmax: 3.0e-15          # Maximum glucose uptake rate

  # Phenotype thresholds
  necrosis_threshold_oxygen: 0.011    # Oxygen threshold for necrosis
  necrosis_threshold_glucose: 0.23    # Glucose threshold for necrosis

  # Migration parameters
  base_migration_rate: 0.0       # Base migration probability

# Custom functions module
custom_functions_module: "jayatilake_experiment_cell_functions"

# Population parameters
initial_cell_count: 13  # Matches the CSV file
max_population_size: 1000

# Output directories
output_dir: "results"
plots_dir: "results/plots"
data_dir: "results/data"
custom_functions_path: "jayatilake_experiment_cell_functions.py"
