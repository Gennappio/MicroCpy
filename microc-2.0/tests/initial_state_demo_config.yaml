# MicroC 2.0 - Initial State System Demo Configuration
# This configuration demonstrates the new 3D initial state generator and loader

# Domain configuration - 3D simulation
domain:
  dimensions: 3
  size_x: 500
  size_x_unit: "um"
  size_y: 500
  size_y_unit: "um"
  size_z: 500
  size_z_unit: "um"
  nx: 25
  ny: 25
  nz: 25
  cell_height: 5
  cell_height_unit: "um"

# Time configuration
time:
  dt: 0.1
  end_time: 1.0  # Short demo simulation
  diffusion_step: 5
  intracellular_step: 1
  intercellular_step: 10

# Diffusion configuration
diffusion:
  max_iterations: 1000
  tolerance: 1e-6
  solver_type: "steady_state"
  twodimensional_adjustment_coefficient: 1.0

# Output and saving configuration
output:
  save_data_interval: 5        # Save data every 5 steps
  save_plots_interval: 5       # Generate plots every 5 steps
  save_final_plots: true       # Always save plots at the end
  save_initial_plots: true     # Always save plots at the beginning
  status_print_interval: 2     # Print detailed status every 2 steps
  save_cellstate_interval: 3   # Save cell states every 3 steps (DEMO FEATURE)

# Initial state configuration (NEW FEATURE)
initial_state:
  mode: "generate"             # Options: "generate" or "load"
  file_path: null              # Path to initial state file (for load mode)
                               # Example: "test_output/initial_states/initial_state_3D_25x25x25_20250805_201351.h5"
  save_initial_state: true     # Save initial state after generation (DEMO FEATURE)

# Substances - minimal set for demo
substances:
  Oxygen:
    diffusion_coeff: 1.0e-9
    production_rate: 0.0
    uptake_rate: 3.0e-17
    initial_value: 0.07
    initial_value_unit: "mM"
    boundary_value: 0.07
    boundary_value_unit: "mM"
    boundary_type: "fixed"
    unit: "mM"

  Lactate:
    diffusion_coeff: 1.8e-10
    production_rate: 8.24e-20
    uptake_rate: 0.0
    initial_value: 1.0
    initial_value_unit: "mM"
    boundary_value: 1.0
    boundary_value_unit: "mM"
    boundary_type: "fixed"
    unit: "mM"

  Glucose:
    diffusion_coeff: 6.70e-11
    production_rate: 0.0
    uptake_rate: 3.0e-15
    initial_value: 5.0
    initial_value_unit: "mM"
    boundary_value: 5.0
    boundary_value_unit: "mM"
    boundary_type: "fixed"
    unit: "mM"

# Gene network configuration
gene_network:
  bnd_file: "jayatilake_experiment/jaya_microc.bnd"
  propagation_steps: 3
  random_initialization: true
  output_nodes: ["Proliferation", "Apoptosis", "Growth_Arrest", "Necrosis"]
  nodes:
    # Input nodes
    Oxygen_supply:
      name: "Oxygen_supply"
      inputs: []
      logic: "True"
      is_input: true
      default_state: true

    Glucose_supply:
      name: "Glucose_supply"
      inputs: []
      logic: "True"
      is_input: true
      default_state: true

    MCT1_stimulus:
      name: "MCT1_stimulus"
      inputs: []
      logic: "False"
      is_input: true
      default_state: false
    
    # Output nodes (fate nodes)
    Proliferation:
      name: "Proliferation"
      inputs: ["Oxygen_supply", "Glucose_supply"]
      logic: "Oxygen_supply and Glucose_supply"
      is_input: false
      is_output: true
      default_state: false

    Apoptosis:
      name: "Apoptosis"
      inputs: ["Oxygen_supply"]
      logic: "not Oxygen_supply"
      is_input: false
      is_output: true
      default_state: false

    Growth_Arrest:
      name: "Growth_Arrest"
      inputs: ["Oxygen_supply", "Glucose_supply"]
      logic: "not (Oxygen_supply and Glucose_supply)"
      is_input: false
      is_output: true
      default_state: false

    Necrosis:
      name: "Necrosis"
      inputs: ["Oxygen_supply"]
      logic: "not Oxygen_supply"
      is_input: false
      is_output: true
      default_state: false

# Substance-gene associations
associations:
  Oxygen: "Oxygen_supply"
  Glucose: "Glucose_supply"
  Lactate: "MCT1_stimulus"

# Thresholds for gene activation
thresholds:
  Oxygen_supply:
    substance: "Oxygen"
    threshold: 0.022
    threshold_unit: "mM"
    operator: ">"

  Glucose_supply:
    substance: "Glucose"
    threshold: 0.5
    threshold_unit: "mM"
    operator: ">"

  MCT1_stimulus:
    substance: "Lactate"
    threshold: 2.0
    threshold_unit: "mM"
    operator: ">"

# Environment configuration
environment:
  ph: 7.4

# Custom parameters
custom_parameters:
  initial_cell_count: 100      # Smaller count for demo
  max_population_size: 500
  max_cell_age: 500.0
  cell_cycle_time: 240
  division_probability: 0.8
  migration_probability: 0.1
  death_probability: 0.01

# File paths
output_dir: "demo_output"
plots_dir: "demo_output/plots"
data_dir: "demo_output/data"
custom_functions_path: "jayatilake_experiment/jayatilake_experiment_custom_functions.py"

# Debug flags
debug_phenotype_detailed: false
log_simulation_status: false
