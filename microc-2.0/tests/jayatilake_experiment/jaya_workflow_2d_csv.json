{
  "version": "1.0",
  "name": "Jayatilake Metabolic Symbiosis Workflow - 2D CSV",
  "description": "Workflow for 2D Jayatilake experiment using CSV initial state - metabolic symbiosis in cancer cells with ATP-based division and gene network phenotype determination",
  "metadata": {
    "author": "MicroCpy Team",
    "experiment": "Jayatilake Metabolic Symbiosis - 2D CSV Version",
    "reference": "Jayatilake et al. 'A computational model of metabolic symbiosis in cancer'",
    "created": "2025-11-14",
    "notes": "Uses CSV file for 2D cell initialization instead of VTK"
  },
  "stages": {
    "initialization": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_simulation",
          "label": "Simulation Parameters",
          "parameters": {
            "name": "Jayatilake Experiment 2D CSV",
            "duration": 0.5,
            "dt": 0.1,
            "output_dir": "results",
            "save_interval": 1,
            "diffusion_step": 1,
            "intracellular_step": 1,
            "intercellular_step": 1
          },
          "position": {
            "x": -150,
            "y": 50
          }
        },
        {
          "id": "param_domain",
          "label": "Domain Parameters",
          "parameters": {
            "dimensions": 2,
            "size_x": 500.0,
            "size_y": 500.0,
            "size_z": 0.0,
            "nx": 25,
            "ny": 25,
            "nz": 1,
            "cell_height": 20.0
          },
          "position": {
            "x": -150,
            "y": 150
          }
        },
        {
          "id": "param_population",
          "label": "Population Parameters",
          "parameters": {
            "enable_gene_network": true,
            "custom_functions_module": "jayatilake_experiment_cell_functions.py"
          },
          "position": {
            "x": -150,
            "y": 250
          }
        },
        {
          "id": "param_output",
          "label": "Output Parameters",
          "parameters": {
            "save_data_interval": 1,
            "save_plots_interval": 1,
            "save_final_plots": true,
            "save_initial_plots": true,
            "status_print_interval": 1,
            "save_cellstate_interval": 1
          },
          "position": {
            "x": -150,
            "y": 350
          }
        },
        {
          "id": "param_csv",
          "label": "CSV File Parameters",
          "parameters": {
            "file_path": "tests/jayatilake_experiment/example_2d_cells.csv"
          },
          "position": {
            "x": -150,
            "y": 450
          }
        },
        {
          "id": "param_fgf",
          "label": "FGF Parameters",
          "parameters": {
            "name": "FGF",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 2e-18,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "FGFR_stimulus"
          },
          "position": {
            "x": -600,
            "y": 100
          }
        },
        {
          "id": "param_oxygen",
          "label": "Oxygen Parameters",
          "parameters": {
            "name": "Oxygen",
            "diffusion_coeff": 1e-09,
            "production_rate": 0.0,
            "uptake_rate": 3e-18,
            "initial_value": 0.07,
            "boundary_value": 0.07,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Oxygen_supply"
          },
          "position": {
            "x": -600,
            "y": 200
          }
        },
        {
          "id": "param_glucose",
          "label": "Glucose Parameters",
          "parameters": {
            "name": "Glucose",
            "diffusion_coeff": 6.7e-11,
            "production_rate": 0.0,
            "uptake_rate": 3e-15,
            "initial_value": 5.0,
            "boundary_value": 5.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Glucose_supply"
          },
          "position": {
            "x": -600,
            "y": 300
          }
        },
        {
          "id": "param_lactate",
          "label": "Lactate Parameters",
          "parameters": {
            "name": "Lactate",
            "diffusion_coeff": 1.8e-10,
            "production_rate": 3e-15,
            "uptake_rate": 0.0,
            "initial_value": 1.0,
            "boundary_value": 1.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "MCT1_stimulus"
          },
          "position": {
            "x": -600,
            "y": 400
          }
        },
        {
          "id": "param_h",
          "label": "H+ (Proton) Parameters",
          "parameters": {
            "name": "H",
            "diffusion_coeff": 1e-09,
            "production_rate": 2e-20,
            "uptake_rate": 3e-15,
            "initial_value": 4e-05,
            "boundary_value": 4e-05,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Proton_level"
          },
          "position": {
            "x": -600,
            "y": 500
          }
        },
        {
          "id": "param_egf",
          "label": "EGF Parameters",
          "parameters": {
            "name": "EGF",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 2e-18,
            "initial_value": 5e-07,
            "boundary_value": 5e-07,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "EGFR_stimulus"
          },
          "position": {
            "x": -600,
            "y": 600
          }
        },
        {
          "id": "param_tgfa",
          "label": "TGFA Parameters",
          "parameters": {
            "name": "TGFA",
            "diffusion_coeff": 5.18e-11,
            "production_rate": 2e-17,
            "uptake_rate": 2e-20,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "EGFR_stimulus"
          },
          "position": {
            "x": -600,
            "y": 700
          }
        },
        {
          "id": "param_hgf",
          "label": "HGF Parameters",
          "parameters": {
            "name": "HGF",
            "diffusion_coeff": 8.5e-11,
            "production_rate": 0.0,
            "uptake_rate": 2e-18,
            "initial_value": 2e-06,
            "boundary_value": 2e-06,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "cMET_stimulus"
          },
          "position": {
            "x": -600,
            "y": 800
          }
        },
        {
          "id": "param_egfrd",
          "label": "EGFRD Parameters",
          "parameters": {
            "name": "EGFRD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "EGFRI"
          },
          "position": {
            "x": -350,
            "y": 100
          }
        },
        {
          "id": "param_fgfrd",
          "label": "FGFRD Parameters",
          "parameters": {
            "name": "FGFRD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "FGFRI"
          },
          "position": {
            "x": -350,
            "y": 200
          }
        },
        {
          "id": "param_gi",
          "label": "GI (Growth Inhibitor) Parameters",
          "parameters": {
            "name": "GI",
            "diffusion_coeff": 5.18e-11,
            "production_rate": 0.0,
            "uptake_rate": 2e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Growth_Inhibitor"
          },
          "position": {
            "x": -350,
            "y": 300
          }
        },
        {
          "id": "param_cmetd",
          "label": "cMETD Parameters",
          "parameters": {
            "name": "cMETD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "cMETI"
          },
          "position": {
            "x": -350,
            "y": 400
          }
        },
        {
          "id": "param_ph",
          "label": "pH Parameters",
          "parameters": {
            "name": "pH",
            "diffusion_coeff": 1e-09,
            "production_rate": 0.0,
            "uptake_rate": 0.0,
            "initial_value": 7.4,
            "boundary_value": 7.4,
            "boundary_type": "fixed",
            "unit": "pH",
            "gene_network_input": ""
          },
          "position": {
            "x": -350,
            "y": 500
          }
        },
        {
          "id": "param_mct1d",
          "label": "MCT1D Parameters",
          "parameters": {
            "name": "MCT1D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "MCT1I"
          },
          "position": {
            "x": -350,
            "y": 600
          }
        },
        {
          "id": "param_mct4d",
          "label": "MCT4D Parameters",
          "parameters": {
            "name": "MCT4D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "MCT4I"
          },
          "position": {
            "x": -350,
            "y": 700
          }
        },
        {
          "id": "param_glut1d",
          "label": "GLUT1D Parameters",
          "parameters": {
            "name": "GLUT1D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "GLUT1I"
          },
          "position": {
            "x": -350,
            "y": 800
          }
        }
      ],
      "functions": [
        {
          "id": "load_config_2d",
          "function_name": "load_config_file",
          "description": "Load Jayatilake 2D CSV YAML configuration and initialize simulation infrastructure",
          "parameters": {
            "config_file": "tests/jayatilake_experiment/jayatilake_experiment_2d_csv_config.yaml"
          },
          "parameter_nodes": [
            "param_simulation",
            "param_domain",
            "param_population",
            "param_output",
            "param_fgf",
            "param_oxygen",
            "param_glucose",
            "param_lactate",
            "param_h",
            "param_egf",
            "param_tgfa",
            "param_hgf",
            "param_egfrd",
            "param_fgfrd",
            "param_gi",
            "param_cmetd",
            "param_ph",
            "param_mct1d",
            "param_mct4d",
            "param_glut1d"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 50
          }
        },
        {
          "id": "load_csv_2d",
          "function_name": "load_cells_from_csv",
          "description": "Load initial cell state from CSV (same as 2D YAML config)",
          "parameters": {},
          "parameter_nodes": [
            "param_csv"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 100
          }
        },
        {
          "id": "init_plots_2d",
          "function_name": "generate_initial_plots",
          "description": "Generate initial state plots (heatmaps, summary)",
          "parameters": {},
          "parameter_nodes": [],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 150
          }
        }
      ],
      "execution_order": [
        "load_config_2d",
        "load_csv_2d",
        "init_plots_2d"
      ]
    },
    "macrostep": {
      "enabled": true,
      "steps": 1,
      "parameters": [],
      "functions": [
        {
          "id": "intracellular_node",
          "function_name": "standard_intracellular_update",
          "description": "Intracellular update (macrostep node controlling intracellular canvas)",
          "parameters": {},
          "enabled": true,
          "position": {
            "x": 100,
            "y": 250
          },
          "step_count": 1
        },
        {
          "id": "microenvironment_node",
          "function_name": "standard_diffusion_update",
          "description": "Microenvironment/diffusion update (macrostep node controlling microenvironment canvas)",
          "parameters": {},
          "enabled": true,
          "position": {
            "x": 350,
            "y": 250
          },
          "step_count": 1
        },
        {
          "id": "intercellular_node",
          "function_name": "standard_intercellular_update",
          "description": "Intercellular update (macrostep node controlling intercellular canvas)",
          "parameters": {},
          "enabled": true,
          "position": {
            "x": 600,
            "y": 250
          },
          "step_count": 1
        },
        {
          "id": "csv_export_node",
          "function_name": "export_csv_checkpoint_conditional",
          "description": "Export CSV checkpoint based on config.output.save_cellstate_interval",
          "parameters": {},
          "enabled": true,
          "position": {
            "x": 850,
            "y": 250
          },
          "step_count": 1
        }
      ],
      "execution_order": [
        "intracellular_node",
        "microenvironment_node",
        "intercellular_node",
        "csv_export_node"
      ]
    },

    "intracellular": {
      "enabled": true,
      "steps": 1,
      "parameters": [
        {
          "id": "param_metabolism",
          "label": "Metabolism Parameters",
          "parameters": {
            "oxygen_consumption_rate": 3e-18,
            "glucose_consumption_rate": 3e-15,
            "lactate_production_rate": 3e-15
          },
          "position": {
            "x": -150,
            "y": 200
          }
        },
        {
          "id": "param_gene_networks",
          "label": "Gene Network Parameters",
          "parameters": {
            "hypoxia_threshold": 0.02,
            "glucose_threshold": 1.0
          },
          "position": {
            "x": -150,
            "y": 300
          }
        },
        {
          "id": "param_death",
          "label": "Cell Death Parameters",
          "parameters": {
            "atp_death_threshold": 0.1
          },
          "position": {
            "x": -150,
            "y": 450
          }
        }
      ],
      "functions": [
        {
          "id": "intracellular_1",
          "function_name": "standard_intracellular_update",
          "description": "Standard intracellular update: metabolism, gene networks, phenotypes, and death via engine helpers (matches YAML behavior)",
          "parameters": {},
          "parameter_nodes": [
            "param_metabolism",
            "param_gene_networks",
            "param_death"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 250
          }
        }
      ],
      "execution_order": [
        "intracellular_1"
      ]
    },
    "microenvironment": {
      "enabled": true,
      "steps": 1,
      "parameters": [
        {
          "id": "param_diffusion",
          "label": "Diffusion Solver Parameters",
          "parameters": {
            "max_iterations": 1000,
            "tolerance": 1e-06,
            "solver_type": "steady_state"
          },
          "position": {
            "x": -100,
            "y": 450
          }
        }
      ],
      "functions": [
        {
          "id": "diffusion_1",
          "function_name": "standard_diffusion_update",
          "description": "Standard diffusion update: run diffusion solver with cell-based reactions (matches YAML engine)",
          "parameters": {},
          "parameter_nodes": [
            "param_diffusion"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 450
          }
        }
      ],
      "execution_order": [
        "diffusion_1"
      ]
    },
    "intercellular": {
      "enabled": true,
      "steps": 1,
      "parameters": [
        {
          "id": "param_division",
          "label": "Cell Division Parameters",
          "parameters": {
            "atp_division_threshold": 2.0
          },
          "position": {
            "x": -150,
            "y": 700
          }
        }
      ],
      "functions": [
        {
          "id": "intercellular_1",
          "function_name": "standard_intercellular_update",
          "description": "Standard intercellular update: division and interactions via engine helpers (matches YAML behavior)",
          "parameters": {},
          "parameter_nodes": [
            "param_division"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 700
          }
        }
      ],
      "execution_order": [
        "intercellular_1"
      ]
    },
    "finalization": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_plots",
          "label": "Plot Parameters",
          "parameters": {
            "output_dir": "results",
            "dpi": 300
          },
          "position": {
            "x": -150,
            "y": 800
          }
        }
      ],
      "functions": [
        {
          "id": "generate_plots_1",
          "function_name": "generate_summary_plots",
          "description": "Generate all summary plots (heatmaps, timeseries, etc.)",
          "parameters": {},
          "parameter_nodes": [
            "param_plots"
          ],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 800
          }
        },
        {
          "id": "print_summary_1",
          "function_name": "print_simulation_summary",
          "description": "Print simulation summary statistics",
          "parameters": {},
          "parameter_nodes": [],
          "enabled": true,
          "position": {
            "x": 300,
            "y": 900
          }
        }
      ],
      "execution_order": [
        "generate_plots_1",
        "print_summary_1"
      ]
    }
  }
}