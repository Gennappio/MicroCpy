{
  "version": "1.0",
  "name": "Jayatilake Metabolic Symbiosis Workflow",
  "description": "Default workflow for Jayatilake experiment - metabolic symbiosis in cancer cells with ATP-based division and gene network phenotype determination",
  "metadata": {
    "author": "MicroCpy Team",
    "experiment": "Jayatilake Metabolic Symbiosis",
    "reference": "Jayatilake et al. 'A computational model of metabolic symbiosis in cancer'",
    "created": "2025-01-10"
  },
  
  "stages": {
    "initialization": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_simulation",
          "label": "Simulation Parameters",
          "parameters": {
            "name": "Jayatilake Experiment 3D",
            "duration": 0.1,
            "dt": 0.1,
            "output_dir": "results/jayatilake_experiment",
            "save_interval": 1,
            "diffusion_step": 1,
            "intracellular_step": 1,
            "intercellular_step": 1
          },
          "position": {"x": -150, "y": 50}
        },
        {
          "id": "param_domain",
          "label": "Domain Parameters",
          "parameters": {
            "dimensions": 3,
            "size_x": 400.0,
            "size_y": 400.0,
            "size_z": 400.0,
            "nx": 25,
            "ny": 25,
            "nz": 25,
            "cell_height": 5.0
          },
          "position": {"x": -150, "y": 150}
        },
        {
          "id": "param_population",
          "label": "Population Parameters",
          "parameters": {
            "enable_gene_network": true,
            "custom_functions_module": "src/config/custom_functions.py"
          },
          "position": {"x": -150, "y": 250}
        },
        {
          "id": "param_output",
          "label": "Output Parameters",
          "parameters": {
            "save_data_interval": 1,
            "save_plots_interval": 1,
            "save_final_plots": true,
            "save_initial_plots": true,
            "status_print_interval": 1,
            "save_cellstate_interval": 1
          },
          "position": {"x": -150, "y": 350}
        },
        {
          "id": "param_vtk",
          "label": "VTK File Parameters",
          "parameters": {
            "file_path": "tools/generated_h5/cells_200um_domain_domain.vtk"
          },
          "position": {"x": -150, "y": 450}
        }
      ],
      "functions": [
        {
          "id": "init_simulation",
          "function_name": "setup_simulation",
          "description": "Setup simulation parameters",
          "parameters": {},
          "parameter_nodes": ["param_simulation"],
          "enabled": true,
          "position": {"x": 300, "y": 50}
        },
        {
          "id": "init_domain",
          "function_name": "setup_domain",
          "description": "Setup domain and mesh",
          "parameters": {},
          "parameter_nodes": ["param_domain"],
          "enabled": true,
          "position": {"x": 300, "y": 150}
        },
        {
          "id": "init_population",
          "function_name": "setup_population",
          "description": "Setup cell population",
          "parameters": {},
          "parameter_nodes": ["param_population"],
          "enabled": true,
          "position": {"x": 300, "y": 250}
        },
        {
          "id": "init_output",
          "function_name": "setup_output",
          "description": "Setup output configuration",
          "parameters": {},
          "parameter_nodes": ["param_output"],
          "enabled": true,
          "position": {"x": 300, "y": 350}
        },
        {
          "id": "init_vtk",
          "function_name": "load_cells_from_vtk",
          "description": "Load initial cell state from VTK file",
          "parameters": {},
          "parameter_nodes": ["param_vtk"],
          "enabled": true,
          "position": {"x": 300, "y": 450}
        }
      ],
      "execution_order": ["init_simulation", "init_domain", "init_population", "init_output", "init_vtk"]
    },
    
    "intracellular": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_metabolism",
          "label": "Metabolism Parameters",
          "parameters": {
            "oxygen_consumption_rate": 3.0e-18,
            "glucose_consumption_rate": 3.0e-15,
            "lactate_production_rate": 3.0e-15,
            "atp_production_aerobic": 36.0,
            "atp_production_glycolytic": 2.0
          },
          "position": {"x": -150, "y": 200}
        },
        {
          "id": "param_gene_networks",
          "label": "Gene Network Parameters",
          "parameters": {
            "hypoxia_threshold": 0.02,
            "glucose_threshold": 1.0
          },
          "position": {"x": -150, "y": 300}
        },
        {
          "id": "param_death",
          "label": "Cell Death Parameters",
          "parameters": {
            "atp_death_threshold": 0.1
          },
          "position": {"x": -150, "y": 450}
        }
      ],
      "functions": [
        {
          "id": "metabolism_1",
          "function_name": "update_metabolism",
          "description": "Update intracellular metabolism (ATP, metabolites)",
          "parameters": {},
          "parameter_nodes": ["param_metabolism"],
          "enabled": true,
          "position": {"x": 300, "y": 200}
        },
        {
          "id": "gene_networks_1",
          "function_name": "update_gene_networks",
          "description": "Update gene networks based on environment (hypoxia, glycolysis genes)",
          "parameters": {},
          "parameter_nodes": ["param_gene_networks"],
          "enabled": true,
          "position": {"x": 300, "y": 300}
        },
        {
          "id": "phenotypes_1",
          "function_name": "update_phenotypes",
          "description": "Update cell phenotypes based on gene states (glycolytic vs oxidative)",
          "parameters": {},
          "parameter_nodes": [],
          "enabled": true,
          "position": {"x": 300, "y": 400}
        },
        {
          "id": "remove_dead_1",
          "function_name": "remove_dead_cells",
          "description": "Remove cells with ATP below death threshold",
          "parameters": {},
          "parameter_nodes": ["param_death"],
          "enabled": true,
          "position": {"x": 300, "y": 500}
        }
      ],
      "execution_order": ["metabolism_1", "gene_networks_1", "phenotypes_1", "remove_dead_1"]
    },

    "microenvironment": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_fgf",
          "label": "FGF Parameters",
          "parameters": {
            "name": "FGF",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0e-21,
            "uptake_rate": 2.0e-18,
            "initial_value": 0.0e-6,
            "boundary_value": 0.0e-6,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "FGFR_stimulus"
          },
          "position": {"x": -600, "y": 100}
        },
        {
          "id": "param_oxygen",
          "label": "Oxygen Parameters",
          "parameters": {
            "name": "Oxygen",
            "diffusion_coeff": 1.0e-9,
            "production_rate": 0.0,
            "uptake_rate": 3.0e-18,
            "initial_value": 0.07,
            "boundary_value": 0.07,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Oxygen_supply"
          },
          "position": {"x": -600, "y": 200}
        },
        {
          "id": "param_glucose",
          "label": "Glucose Parameters",
          "parameters": {
            "name": "Glucose",
            "diffusion_coeff": 6.70e-11,
            "production_rate": 0.0,
            "uptake_rate": 3.0e-15,
            "initial_value": 5.0,
            "boundary_value": 5.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Glucose_supply"
          },
          "position": {"x": -600, "y": 300}
        },
        {
          "id": "param_lactate",
          "label": "Lactate Parameters",
          "parameters": {
            "name": "Lactate",
            "diffusion_coeff": 1.8e-10,
            "production_rate": 3.0e-15,
            "uptake_rate": 0.0e-15,
            "initial_value": 1.0,
            "boundary_value": 1.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "MCT1_stimulus"
          },
          "position": {"x": -600, "y": 400}
        },
        {
          "id": "param_h",
          "label": "H+ (Proton) Parameters",
          "parameters": {
            "name": "H",
            "diffusion_coeff": 1.0e-9,
            "production_rate": 2.0e-20,
            "uptake_rate": 3.0e-15,
            "initial_value": 4.0e-5,
            "boundary_value": 4.0e-5,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Proton_level"
          },
          "position": {"x": -600, "y": 500}
        },
        {
          "id": "param_egf",
          "label": "EGF Parameters",
          "parameters": {
            "name": "EGF",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 2.0e-18,
            "initial_value": 5.0e-7,
            "boundary_value": 5.0e-7,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "EGFR_stimulus"
          },
          "position": {"x": -600, "y": 600}
        },
        {
          "id": "param_tgfa",
          "label": "TGFA Parameters",
          "parameters": {
            "name": "TGFA",
            "diffusion_coeff": 5.18e-11,
            "production_rate": 2.0e-17,
            "uptake_rate": 2.0e-20,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "EGFR_stimulus"
          },
          "position": {"x": -600, "y": 700}
        },
        {
          "id": "param_hgf",
          "label": "HGF Parameters",
          "parameters": {
            "name": "HGF",
            "diffusion_coeff": 8.50e-11,
            "production_rate": 0.0e-21,
            "uptake_rate": 2.0e-18,
            "initial_value": 2.0e-6,
            "boundary_value": 2.0e-6,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "cMET_stimulus"
          },
          "position": {"x": -600, "y": 800}
        },
        {
          "id": "param_egfrd",
          "label": "EGFRD Parameters",
          "parameters": {
            "name": "EGFRD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-3,
            "boundary_value": 0.0e-3,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "EGFRI"
          },
          "position": {"x": -350, "y": 100}
        },
        {
          "id": "param_fgfrd",
          "label": "FGFRD Parameters",
          "parameters": {
            "name": "FGFRD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-3,
            "boundary_value": 0.0e-3,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "FGFRI"
          },
          "position": {"x": -350, "y": 200}
        },
        {
          "id": "param_gi",
          "label": "GI (Growth Inhibitor) Parameters",
          "parameters": {
            "name": "GI",
            "diffusion_coeff": 5.18e-11,
            "production_rate": 0.0e-20,
            "uptake_rate": 2.0e-17,
            "initial_value": 0.0,
            "boundary_value": 0.0,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "Growth_Inhibitor"
          },
          "position": {"x": -350, "y": 300}
        },
        {
          "id": "param_cmetd",
          "label": "cMETD Parameters",
          "parameters": {
            "name": "cMETD",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-3,
            "boundary_value": 0.0e-3,
            "boundary_type": "fixed",
            "unit": "mM",
            "gene_network_input": "cMETI"
          },
          "position": {"x": -350, "y": 400}
        },
        {
          "id": "param_ph",
          "label": "pH Parameters",
          "parameters": {
            "name": "pH",
            "diffusion_coeff": 1.0e-9,
            "production_rate": 0.0,
            "uptake_rate": 0.0,
            "initial_value": 7.4,
            "boundary_value": 7.4,
            "boundary_type": "fixed",
            "unit": "pH",
            "gene_network_input": ""
          },
          "position": {"x": -350, "y": 500}
        },
        {
          "id": "param_mct1d",
          "label": "MCT1D Parameters",
          "parameters": {
            "name": "MCT1D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-6,
            "boundary_value": 0.0e-6,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "MCT1I"
          },
          "position": {"x": -350, "y": 600}
        },
        {
          "id": "param_mct4d",
          "label": "MCT4D Parameters",
          "parameters": {
            "name": "MCT4D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-6,
            "boundary_value": 0.0e-6,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "MCT4I"
          },
          "position": {"x": -350, "y": 700}
        },
        {
          "id": "param_glut1d",
          "label": "GLUT1D Parameters",
          "parameters": {
            "name": "GLUT1D",
            "diffusion_coeff": 2.2e-10,
            "production_rate": 0.0,
            "uptake_rate": 4.0e-17,
            "initial_value": 0.0e-6,
            "boundary_value": 0.0e-6,
            "boundary_type": "fixed",
            "unit": "uM",
            "gene_network_input": "GLUT1I"
          },
          "position": {"x": -350, "y": 800}
        },
        {
          "id": "param_diffusion",
          "label": "Diffusion Solver Parameters",
          "parameters": {
            "max_iterations": 1000,
            "tolerance": 1e-6,
            "solver_type": "steady_state"
          },
          "position": {"x": -100, "y": 450}
        }
      ],
      "functions": [
        {
          "id": "diffusion_solver_1",
          "function_name": "run_diffusion_solver",
          "description": "Run diffusion PDE solver for all substances",
          "parameters": {},
          "parameter_nodes": [
            "param_fgf",
            "param_oxygen",
            "param_glucose",
            "param_lactate",
            "param_h",
            "param_egf",
            "param_tgfa",
            "param_hgf",
            "param_egfrd",
            "param_fgfrd",
            "param_gi",
            "param_cmetd",
            "param_ph",
            "param_mct1d",
            "param_mct4d",
            "param_glut1d",
            "param_diffusion"
          ],
          "enabled": true,
          "position": {"x": 300, "y": 450}
        }
      ],
      "execution_order": ["diffusion_solver_1"]
    },

    "intercellular": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_division",
          "label": "Cell Division Parameters",
          "parameters": {
            "atp_division_threshold": 2.0,
            "division_probability": 0.1
          },
          "position": {"x": -150, "y": 700}
        }
      ],
      "functions": [
        {
          "id": "cell_division_1",
          "function_name": "update_cell_division",
          "description": "ATP-based cell division (divide when ATP > threshold)",
          "parameters": {},
          "parameter_nodes": ["param_division"],
          "enabled": true,
          "position": {"x": 300, "y": 700}
        }
      ],
      "execution_order": ["cell_division_1"]
    },

    "finalization": {
      "enabled": true,
      "parameters": [
        {
          "id": "param_plots",
          "label": "Plot Generation Parameters",
          "parameters": {
            "output_dir": "results",
            "plot_format": "png",
            "dpi": 300
          },
          "position": {"x": -150, "y": 800}
        }
      ],
      "functions": [
        {
          "id": "generate_plots_1",
          "function_name": "generate_summary_plots",
          "description": "Generate all summary plots (heatmaps, timeseries, etc.)",
          "parameters": {},
          "parameter_nodes": ["param_plots"],
          "enabled": true,
          "position": {"x": 300, "y": 800}
        },
        {
          "id": "print_summary_1",
          "function_name": "print_simulation_summary",
          "description": "Print simulation summary statistics",
          "parameters": {},
          "parameter_nodes": [],
          "enabled": true,
          "position": {"x": 300, "y": 900}
        }
      ],
      "execution_order": ["generate_plots_1", "print_summary_1"]
    }
  }
}

