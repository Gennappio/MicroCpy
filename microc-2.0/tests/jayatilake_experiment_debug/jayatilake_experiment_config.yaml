# DEBUG FLAGS
# Set to true to enable detailed cell-by-cell phenotype debugging
debug_phenotype_detailed: false
# Set to true to enable structured simulation status logging
log_simulation_status: true

# Jayatilake Metabolic Symbiosis Experiment Configuration
# Based on: Jayatilake et al. "A computational model of metabolic symbiosis in cancer"
# Replicates the NetLogo model parameters and gene network logic

# Domain configuration - 3D spheroid simulation
domain:
  size_x: 1500.0
  size_x_unit: "um"
  size_y: 1500.0
  size_y_unit: "um"
  nx: 75
  ny: 75
  dimensions: 2
  cell_height: 20.0          # Biological cell height/thickness (testing position changes)
  cell_height_unit: "um"     # Can be changed to make cells thicker/thinner

# Time configuration with multi-timescale orchestration
time:
  dt: 0.1
  end_time: 0.1  # Run longer to ensure multiple diffusion updates
  diffusion_step: 2      # Update diffusion every 2 steps (medium speed) CHANGE!
  intracellular_step: 1  # Update gene networks every step (fast)
  intercellular_step: 5  # Update cell interactions every 5 steps (slow)

# Diffusion solver configuration - MATCH STANDALONE
diffusion:
  max_iterations: 1000        # MATCH STANDALONE: Increased for better accuracy
  tolerance: 1e-6             # MATCH STANDALONE: Stricter tolerance for better convergence
  solver_type: "steady_state" # Use steady state solver
  twodimensional_adjustment_coefficient: 1.0  # Fixed: Use proper volume calculation instead

# Output and saving configuration
output:
  save_data_interval: 1000     # Save data every 10 steps
  save_plots_interval: 1000        # Generate plots every 2 steps (for testing)
  save_final_plots: true     # Always save plots at the end
  save_initial_plots: true   # Always save plots at the beginning
  status_print_interval: 1000  # Print detailed status every 10 steps

# Substances - from diffusion-parameters.txt
substances:
  FGF:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0e-21
    uptake_rate: 2.0e-18
    initial_value: 0.0e-6
    boundary_value: 0.0e-6
    boundary_type: "fixed"
    unit: "uM"

  Oxygen:
    diffusion_coeff: 1.0e-9
    production_rate: 0.00
    uptake_rate: 3.0e-18
    initial_value: 0.07
    boundary_value: 0.07
    boundary_type: "fixed"
    unit: "mM"

  Glucose:
    diffusion_coeff: 6.70e-11
    production_rate: 0.0
    uptake_rate: 3.0e-15
    initial_value: 5.0
    boundary_value: 5.0
    boundary_type: "fixed"
    unit: "mM"

  Lactate:
    diffusion_coeff: 1.8e-10  # MATCH STANDALONE
    production_rate: 3.0e-15
    uptake_rate: 0.0e-15
    initial_value: 1.00
    boundary_value: 1.00
    boundary_type: "fixed"
    unit: "mM"

  H:
    diffusion_coeff: 1.0e-9
    production_rate: 2.0e-20
    uptake_rate: 3.0e-15
    initial_value: 4.0e-5
    boundary_value: 4.0e-5
    boundary_type: "fixed"
    unit: "mM"

  EGF:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 2.0e-18
    initial_value: 5.0e-7
    boundary_value: 5.0e-7
    boundary_type: "fixed"
    unit: "uM"

  TGFA:
    diffusion_coeff: 5.18e-11
    production_rate: 2.0e-17
    uptake_rate: 2.0e-20
    initial_value: 0.000
    boundary_value: 0.000
    boundary_type: "fixed"
    unit: "uM"

  HGF:
    diffusion_coeff: 8.50e-11
    production_rate: 0.0e-21
    uptake_rate: 2.0e-18
    initial_value: 2.0e-6
    boundary_value: 2.0e-6
    boundary_type: "fixed"
    unit: "uM"

  EGFRD:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-3
    boundary_value: 0.0e-3
    boundary_type: "fixed"
    unit: "mM"

  FGFRD:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-3
    boundary_value: 0.0e-3
    boundary_type: "fixed"
    unit: "mM"

  GI:
    diffusion_coeff: 5.18e-11
    production_rate: 0.0e-20
    uptake_rate: 2.0e-17
    initial_value: 0.000
    boundary_value: 0.000
    boundary_type: "fixed"
    unit: "mM"

  cMETD:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-3
    boundary_value: 0.0e-3
    boundary_type: "fixed"
    unit: "mM"

  pH:
    diffusion_coeff: 1.0e-9
    production_rate: 0.0
    uptake_rate: 0.0
    initial_value: 7.4
    boundary_value: 7.4
    boundary_type: "fixed"
    unit: "pH"

  MCT1D:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-6
    boundary_value: 0.0e-6
    boundary_type: "fixed"
    unit: "uM"

  MCT4D:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-6
    boundary_value: 0.0e-6
    boundary_type: "fixed"
    unit: "uM"

  GLUT1D:
    diffusion_coeff: 2.2e-10
    production_rate: 0.0
    uptake_rate: 4.0e-17
    initial_value: 0.0e-6
    boundary_value: 0.0e-6
    boundary_type: "fixed"
    unit: "uM"

associations:
  Oxygen: "Oxygen_supply"
  Glucose: "Glucose_supply"
  Lactate: "MCT1_stimulus"
  H: "Proton_level"
  FGF: "FGFR_stimulus"
  TGFA: "EGFR_stimulus"
  HGF: "cMET_stimulus"
  EGFRD: "EGFRI"
  FGFRD: "FGFRI"
  GI: "Growth_Inhibitor"
  cMETD: "cMETI"
  MCT1D: "MCT1I"
  MCT4D: "MCT4I"
  GLUT1D: "GLUT1I"

thresholds:
  Oxygen_supply:
    threshold: 0.022
  Glucose_supply:
    threshold: 4.0
  MCT1_stimulus:
    threshold: 1.5
  Proton_level:
    threshold: 8.0e-5
  FGFR_stimulus:
    threshold: 1.0e-6
  EGFR_stimulus:
    threshold: 1.0e-6
  cMET_stimulus:
    threshold: 1.0e-6
  Growth_Inhibitor:
    threshold: 0.00005
  DNA_damage:
    threshold: 0.5
  TGFBR_stimulus:
    threshold: 0.5
  GLUT1I:
    threshold: 4.0e-6
  GLUT1D:
    threshold: 0.5
  EGFRI:
    threshold: 0.005
  FGFRI:
    threshold: 0.005
  cMETI:
    threshold: 0.005
  MCT1I:
    threshold: 1.7e-5
  MCT4I:
    threshold: 1.0
  pH_min:
    threshold: 6.0

gene_network:
  bnd_file: "tests/jayatilake_experiment/jaya_microc.bnd"
  propagation_steps: 50
  random_initialization: true
  output_nodes: ["Proliferation", "Apoptosis", "Growth_Arrest", "Necrosis"]
  nodes:
    Oxygen_supply: { is_input: true, default_state: true }
    Glucose_supply: { is_input: true, default_state: true }
    MCT1_stimulus: { is_input: true, default_state: true }
    Proton_level: { is_input: true, default_state: false }
    FGFR_stimulus: { is_input: true, default_state: false }
    EGFR_stimulus: { is_input: true, default_state: false }
    cMET_stimulus: { is_input: true, default_state: false }
    Growth_Inhibitor: { is_input: true, default_state: false }
    DNA_damage: { is_input: true, default_state: false }
    TGFBR_stimulus: { is_input: true, default_state: false }
    GLUT1I: { is_input: true, default_state: false }
    GLUT1D: { is_input: true, default_state: false }
    EGFRI: { is_input: true, default_state: false }
    FGFRI: { is_input: true, default_state: false }
    cMETI: { is_input: true, default_state: false }
    MCT1I: { is_input: true, default_state: false }
    MCT4I: { is_input: true, default_state: false }

environment:
  ph: 7.4

custom_parameters:
  cell_cycle_time: 240
  max_cell_age: 500.0
  max_atp: 30
  max_atp_rate: 1.0e-14
  atp_threshold: 0.8
  glyco_oxygen_ratio: 0.1
  proton_coefficient: 0.01
  glucose_factor: 2
  KG: 0.5
  KO2: 0.01
  KL: 1.0
  the_optimal_oxygen: 0.005
  the_optimal_glucose: 0.04
  the_optimal_lactate: 0.04
  oxygen_vmax: 1.0e-16
  glucose_vmax: 3.0e-15
  mu_o2: 1.0e-15
  A0: 30.0
  beta: 0.1
  K_glyco: 0.5
  tgfa_consumption_rate: 2.0e-20
  tgfa_production_rate: 2.0e-17
  hgf_consumption_rate: 2.0e-18
  hgf_production_rate: 0.0
  fgf_consumption_rate: 2.0e-18
  fgf_production_rate: 0.0
  min_glucose_for_glycolysis: 0.1
  min_oxygen_for_oxphos: 0.01
  min_lactate_for_consumption: 0.1
  glucose_depletion_threshold: 0.05
  lactate_saturation_threshold: 8.0
  oxygen_switch_threshold: 0.015
  ph_inhibition_threshold: 1.0e-4
  necrosis_threshold_oxygen: 0.011
  necrosis_threshold_glucose: 0.23
  initial_cell_count: 1
  maximum_cell_count: 5000
  shedding_rate: 0.01
  shedding_starting_time: 0

output_dir: "results/jayatilake_experiment"
plots_dir: "plots/jayatilake_experiment"
data_dir: "data/jayatilake_experiment"
custom_functions_path: "tests/jayatilake_experiment/jayatilake_experiment_custom_functions.py"